<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="How to analyse the periodicity of the onsets.
">
<title>Analysis of periodicity • onsetsync</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of periodicity">
<meta property="og:description" content="How to analyse the periodicity of the onsets.
">
<meta property="og:image" content="https://github.com/tuomaseerola/onsetsync/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">onsetsync</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/onsetsync.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/adding_annotations.html">Adding Annotations</a>
    <a class="dropdown-item" href="../articles/advanced_topics.html">Advanced topics</a>
    <a class="dropdown-item" href="../articles/analysis_example.html">Analysis Example</a>
    <a class="dropdown-item" href="../articles/analysis_of_periodicity.html">Analysis of periodicity</a>
    <a class="dropdown-item" href="../articles/minimal-representation.html">Minimal representation</a>
    <a class="dropdown-item" href="../articles/synthesise_onsets.html">Synthesise onsets</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analysis of periodicity</h1>
            
      
      
      <div class="d-none name"><code>analysis_of_periodicity.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="analysis-of-periodicity">Analysis of periodicity<a class="anchor" aria-label="anchor" href="#analysis-of-periodicity"></a>
</h2>
<p>We can also explore the periodic nature of the instrument onset times
without reference to the metrical structure. Functions described in this
part may in fact be particularly useful in other musical genres which do
not exhibit a clear metrical structure; nonetheless they are illustrated
here using the example used in the previous analyses.</p>
<p>Let’s take the guitar onsets in the first example () and define an
extract of 5 seconds starting from 1 minute mark. We know from the
previous analyses that guitar keeps a fairly steady beat, separated by
about 0.25 seconds while leaving out some beats.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">onsetsync</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">CSS_Song2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">onsetsync</span><span class="fu">::</span><span class="va"><a href="../reference/CSS_IEMP.html">CSS_IEMP</a></span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  <span class="va">Piece</span>, <span class="va">Section</span>, <span class="va">Clave</span>, <span class="va">Bass</span>, <span class="va">Guitar</span>, <span class="va">Tres</span>, </span>
<span>  <span class="va">SD</span>, <span class="va">Cycle</span>, <span class="va">Isochronous.SD.Time</span><span class="op">)</span></span>
<span><span class="va">extract</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">CSS_Song2</span>, <span class="va">Guitar</span> <span class="op">&gt;=</span> <span class="fl">60</span> <span class="op">&amp;</span> <span class="va">Guitar</span> <span class="op">&lt;</span> <span class="fl">65</span><span class="op">)</span></span>
<span><span class="va">fig2A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gaussify_onsets.html">gaussify_onsets</a></span><span class="op">(</span><span class="va">extract</span><span class="op">$</span><span class="va">Guitar</span>, wlen <span class="op">=</span> <span class="fl">0.2</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For the periodicity analyses, we want to transform the discrete
onsets to continuous time representation with an uniform sampling rate.
This is done with the function. This makes the comparisons of the models
easier and allows us to handle time more explicitly. From this new
continuous representation, we can estimate the periodicity of the guitar
strokes by using different methods; Here we demonstrate (a) a simple
time difference method, (b) method based on autocorrelation, and (c)
fast fourier transform. We constrain the frequency to a range of 0.05 to
0.50 seconds. After the extraction of periodicity with function, we plot
the estimated frequency curves (Figure 1).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">frq_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="va">fig2B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodicity.html">periodicity</a></span><span class="op">(</span><span class="va">extract</span>, instr <span class="op">=</span> <span class="st">"Guitar"</span>, </span>
<span>  freq_range<span class="op">=</span><span class="va">frq_range</span>, method <span class="op">=</span> <span class="st">"diff"</span>, title <span class="op">=</span> <span class="st">"Difference"</span><span class="op">)</span></span>
<span><span class="va">fig2C</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodicity.html">periodicity</a></span><span class="op">(</span><span class="va">extract</span>, instr<span class="op">=</span><span class="st">"Guitar"</span>, </span>
<span>  freq_range<span class="op">=</span><span class="va">frq_range</span>, method <span class="op">=</span> <span class="st">"acf"</span>,title <span class="op">=</span> <span class="st">"Autocorrelation"</span><span class="op">)</span></span>
<span><span class="va">fig2D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodicity.html">periodicity</a></span><span class="op">(</span><span class="va">extract</span>, instr<span class="op">=</span><span class="st">"Guitar"</span>, </span>
<span>  freq_range<span class="op">=</span><span class="va">frq_range</span>, method <span class="op">=</span> <span class="st">"per"</span>,title <span class="op">=</span> <span class="st">"FFT"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="analysis_of_periodicity_files/figure-html/figure1-1.png" alt="Figure 1. Periodicity analysis of a 5-second extract of guitar playing in Cuban son. Panel A shows the onsets (red) and the conversion into gaussian distributions (blue) for a continuous representation. " width="672"><p class="caption">
Figure 1. Periodicity analysis of a 5-second extract of guitar playing
in Cuban son. Panel A shows the onsets (red) and the conversion into
gaussian distributions (blue) for a continuous representation.
</p>
</div>
<div class="figure">
<img src="analysis_of_periodicity_files/figure-html/figure2-1.png" alt="Figure 2. Periodicity analysis of a 5-second extract of guitar playing in Cuban son using difference in onset times as a primitive periodicity measure, the output from autocorrelation function, and the estimation of periodicity by FFT." width="672"><p class="caption">
Figure 2. Periodicity analysis of a 5-second extract of guitar playing
in Cuban son using difference in onset times as a primitive periodicity
measure, the output from autocorrelation function, and the estimation of
periodicity by FFT.
</p>
</div>
<p>From the estimated periodicity curves, we can obtain the peak period
in milliseconds, and if we so wish, we convert this into beats per
minute (BPM). For the latter convention, we make use of the fact that
the guitar plays four times per four beats.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarise_periodicity.html">summarise_periodicity</a></span><span class="op">(</span><span class="va">fig2D</span><span class="op">$</span><span class="va">Curve</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Period of'</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">PM</span><span class="op">$</span><span class="va">Per</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span>,<span class="st">'ms'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Period of 217 ms"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="../reference/period_to_BPM.html">period_to_BPM</a></span><span class="op">(</span><span class="va">PM</span><span class="op">$</span><span class="va">Per</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span>,<span class="st">'BPM'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "69 BPM"</span></span></code></pre>
<div class="figure">
<img src="analysis_of_periodicity_files/figure-html/figure3-1.png" alt="Figure 2. Periodicity analysis of four selected instruments in the example song (Palo Alto). The grid lines indicate multiples of the period identified earlier as the underlying beat (217 ms)." width="672"><p class="caption">
Figure 2. Periodicity analysis of four selected instruments in the
example song (Palo Alto). The grid lines indicate multiples of the
period identified earlier as the underlying beat (217 ms).
</p>
</div>
<p>Being able to bring periodicity estimation of onset sequences into
the analysis of asynchrony has many useful purposes. It can serve as a
diagnostic into the periodic patterns performed by the instruments. This
might be particularly useful if no annotation about the cycles and beat
subdivisions is available and the analyst is trying to determine what
are the periodicities exhibited by the different instruments. For
instance, Figure 7 shows the periodicities of the selected four
instruments in our salsa example. The analysis reveals that guitar and
the tres tend to play the fastest beat pulsation (0.22 s) while the tres
occasionally ventures into double (0.44 s) and four times the period
(0.88 s). Bass shows three dominant periods, one at the fastest beat
pulsation level (0.22), double of that period (0.44) and two uneven
subdivisions of the underlying beat (0.35 s and 0.58 s). The clave’s
pattern includes a period of 0.66 secs, three times the fastest pulse,
presumably thanks to its pattern at the start of the cycle (when it
plays on subdivisions 1, 4 &amp; 7).</p>
<p><a href="https://tuomaseerola.github.io/onsetsync/articles/onsetsync.html" class="external-link">Back
to Documentation</a></p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tuomas Eerola.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
